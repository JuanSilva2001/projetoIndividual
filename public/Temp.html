<!DOCTYPE html>
<html lang="pt-br">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Projeto Individual </title>
    <link rel="stylesheet" href="style.css">
</head>

<body onload="Fase(3);verificar();">
    <div class="header">
        <ul class="UL_Esquerda">
            <li><a class='Escolhido' href="Temp.html">Temporada</a></li>
            <li><a href="Hist.html">Historia</a></li>
        </ul>
        <a href="index.html"><img src='./Imagens/marca.png'></a>
        <ul class="UL_Direita">
            <li><a>Estatistica</a>
                <ul>
                    <li><a href="Estatistica.html">Atual</a></li>
                    <li><a href="estHist.html">Historia</a></li>
                </ul>
            </li>
            <li><a id='idLogin'></a></li>
        </ul>
    </div>

    <div class="Rodada">
        <div class='Meio'>
            <button style="float: left;" onclick="anteriorRodada()"><img src="./Imagens/setaEsquerda.png"></button>
            <p id='idRodada'>Fase de Grupos</p>
            <button style="float: right;" onclick="proximaRodada()"><img src="./Imagens/setaDireita.png"></button>
        </div>
    </div>
    <div id='Jogos'>

    </div>
</body>

</html>

<script>
    var Fases = ['Rodada 1', 'Rodada 2', 'Rodada 3', 'Fase de Grupos', 'Oitavas', 'Quartas', 'Semi', 'Final'];
    var qualRodada = 3;
    function Teste(){
        fetch(`/jogos/Partida/${qualRodada}`, {cache:'no-store'}).then(resposta => {
        if (resposta.ok) {
            resposta.json().then(json => {
                switch (qualRodada){
                    case 0:
                    for(var contador=0; contador<6; contador+=2){
                        var dadosPrimeiroJogo=converterDia(json[contador].dia)+' '+json[contador].estadioJogo+ ' '+ json[contador].horas;
                        var dadosSegundoJogo=converterDia(json[json.length-(6-contador)].dia)+' '+json[json.length-(6-contador)].estadioJogo+ ' '+ json[json.length-(6-contador)].horas;
                        var placarIda= (json[contador].golsFeitosJogo).toString() + (json[contador+1].golsFeitosJogo).toString();
                        var placarVolta= (json[json.length-(6-contador)].golsFeitosJogo).toString() + (json[json.length-(5-contador)].golsFeitosJogo).toString();
                        console.log(placarVolta);
                        Jogos.innerHTML+=matamata(
                            json[contador].Abreviacao,
                            json[contador+1].Abreviacao,
                            dadosPrimeiroJogo,
                            dadosSegundoJogo,
                            placarIda,
                            placarVolta
                            );
                    }
                    break;
                    case 1:
                    for(var contador=0; contador<16; contador+=2){
                        var dadosPrimeiroJogo=converterDia(json[contador].dia)+' '+json[contador].estadioJogo+ ' '+ json[contador].horas;
                        var dadosSegundoJogo=converterDia(json[json.length-(16-contador)].dia)+' '+json[json.length-(16-contador)].estadioJogo+ ' '+ json[json.length-(16-contador)].horas;
                        var placarIda= (json[contador].golsFeitosJogo).toString() + (json[contador+1].golsFeitosJogo).toString();
                        var placarVolta= (json[json.length-(16-contador)].golsFeitosJogo).toString() + (json[json.length-(15-contador)].golsFeitosJogo).toString();
                        console.log(placarVolta);
                        Jogos.innerHTML+=matamata(
                            json[contador].Abreviacao,
                            json[contador+1].Abreviacao,
                            dadosPrimeiroJogo,
                            dadosSegundoJogo,
                            placarIda,
                            placarVolta
                            );
                            console.log(contador);
                    }
                    break;
                    case 2:
                    for(var contador=0; contador<8; contador+=2){
                        var dadosPrimeiroJogo=converterDia(json[contador].dia)+' '+json[contador].estadioJogo+ ' '+ json[contador].horas;
                        var dadosSegundoJogo=converterDia(json[json.length-(8-contador)].dia)+' '+json[json.length-(8-contador)].estadioJogo+ ' '+ json[json.length-(8-contador)].horas;
                        var placarIda= (json[contador].golsFeitosJogo).toString() + (json[contador+1].golsFeitosJogo).toString();
                        var placarVolta= (json[json.length-(8-contador)].golsFeitosJogo).toString() + (json[json.length-(7-contador)].golsFeitosJogo).toString();
                        console.log(placarVolta);
                        Jogos.innerHTML+=matamata(
                            json[contador].Abreviacao,
                            json[contador+1].Abreviacao,
                            dadosPrimeiroJogo,
                            dadosSegundoJogo,
                            placarIda,
                            placarVolta
                            );
                            console.log(contador);
                    }
                    break;
                    case 3:
                        var vetorTimesGrupos= [];
                        var vetorDadosGrupos= [];
                        
                        var vetorGrupos=['A','B','C','D','E','F','G','H'];
                        for(var contador=0; contador<8;contador++){
                            var vetorTimesPorGrupo=[];
                            var vetorDadosPorGrupo=[];
                            for(var contadorTimes=(4*contador);contadorTimes<(4*(1+contador));contadorTimes++){
                                vetorTimesPorGrupo.push(json[contadorTimes].nomeTime);
                                var vetorDadosTime=[];
                                vetorDadosTime.push((json[contadorTimes].P).toString());
                                vetorDadosTime.push((json[contadorTimes].J).toString());
                                vetorDadosTime.push((json[contadorTimes].V).toString());
                                vetorDadosTime.push((json[contadorTimes].E).toString());
                                vetorDadosTime.push((json[contadorTimes].D).toString());
                                vetorDadosTime.push((json[contadorTimes].GP).toString());
                                vetorDadosTime.push((json[contadorTimes].GC).toString());
                                vetorDadosTime.push((json[contadorTimes].SG).toString());
                                vetorDadosTime.push((json[contadorTimes].Aproveitamento).toString());
                                vetorDadosPorGrupo.push(vetorDadosTime);
                            }
                            console.log(vetorDadosPorGrupo);
                            Jogos.innerHTML+=Grupo(vetorGrupos[contador], vetorTimesPorGrupo, vetorDadosPorGrupo);
                        }
                        
                    break;
                }
            });
        } else {
            console.error(resposta);
            console.log('Abc');
        } 
    }); 
}
    function proximaRodada() {
        if (qualRodada < 7 && qualRodada >= 0) {
            qualRodada++;
            idRodada.innerHTML = Fases[qualRodada];
            Fase(qualRodada);
        }
    }
    function anteriorRodada() {
        if (qualRodada < 8 && qualRodada > 0) {
            qualRodada--;
            idRodada.innerHTML = Fases[qualRodada];
            Fase(qualRodada);
        }
    }
    
    function Fase(numero) {
        /*if (numero == 3) {
            for(var contador=0; contador<8; contador++){
            Jogos.innerHTML = 
        <table class='Grupo'>
            <tr>
                <th colspan="7">
                    <table id='rodadaGrupo'>
                        <tr>
                            <td><button><h1><</h1></button></td>
                            <td><p id='idRodadaGrupo'>Rodada 1</p></td>
                            <td><button><h1>></h1></button></td>
                        </tr>
                    </table>
                </th>
            </tr>
            <tr id='jogoGrupo'>
                <td>
                    <img src='./Logo.png'>
                </td>
                <td>
                    <span class="Time">AAA</span>
                </td>
                <td>
                    <span class="Placar">0</span>
                </td>
                <td>
                    <span class="X">X</span>
                </td>
                <td>
                    <span class="Placar">0</span>
                </td>
                <td>
                    <span class="Time">AAA</span>
                </td>
                <td>
                    <img src='./Logo.png'>
                </td>
            </tr>
            <tr id='jogoGrupo'>
                <td>
                    <img src='./Logo.png'>
                </td>
                <td>
                    <span class="Time">AAA</span>
                </td>
                <td>
                    <span class="Placar">0</span>
                </td>
                <td>
                    <span class="X">X</span>
                </td>
                <td>
                    <span class="Placar">0</span>
                </td>
                <td>
                    <span class="Time">AAA</span>
                </td>
                <td>
                    <img src='./Logo.png'>
                </td>
            </td>
            </tr>
        </table>
            `;
        }*/
        /*else if(numero==7){
            Jogos.innerHTML = `<table class="Confronto">
            <tr>
                <th colspan="7">SAB-20/11 Centenario(URU)</th>
            </tr>
        <tr class="Casa">
            <td>
                <img src='./Logo.png'>
            </td>
            <td>
                <span class="Time">AAA</span>
            </td>
            <td>
                <span class="Placar">0</span>
            </td>
            <td>
                <span class="X">X</span>
            </td>
            <td>
                <span class="Placar">0</span>
            </td>
            <td>
                <span class="Time">AAA</span>
            </td>
            <td>
                <img src='./Logo.png'>
            </td>
        </tr>
        </table>
    </tr>
    </table>`;
        }
        else{*/
            switch (qualRodada){
                case 0:
                    Jogos.innerHTML="";
                    Teste();
                break;
                case 1:
                    Jogos.innerHTML="";
                    Teste();
                break;
                case 2:
                    Jogos.innerHTML="";
                    Teste();
                break;
                case 3:
                    Jogos.innerHTML="";
                    Teste();
                break;
            }
        }
    //}

    function matamata(timeCasa, timeFora, dadosJogo1, dadosJogo2, placaJogo1, placaJogo2){
        var tabela = 
        `<table class="Confronto">
            <tr>
                <th colspan="7" style='border-right: #F2C063 3px solid;'>${dadosJogo1}</th>
                <th colspan="7">${dadosJogo2}</th>
            </tr>
        <tr class="Casa">
            <td>
                <img src='./Imagens/Times/${timeCasa}.png'>
            </td>
            <td>
                <span class="Time">${timeCasa}</span>
            </td>
            <td>
                <span class="Placar">${placaJogo1[0]}</span>
            </td>
            <td>
                <span class="X">X</span>
            </td>
            <td>
                <span class="Placar">${placaJogo1[1]}</span>
            </td>
            <td>
                <span class="Time">${timeFora}</span>
            </td>
            <td style='border-right: #F2C063 3px solid;'>
                <img src='./Imagens/Times/${timeFora}.png'>
            </td>
            <td>
                <img src='./Imagens/Times/${timeFora}.png'>
            </td>
            <td>
                <span class="Time">${timeFora}</span>
            </td>
            <td>
                <span class="Placar">${placaJogo2[0]}</span>
            </td>
            <td>
                <span class="X">X</span>
            </td>
            <td>
                <span class="Placar">${placaJogo2[1]}</span>
            </td>
            <td>
                <span class="Time">${timeCasa}</span>
            </td>
            <td>
                <img src='./Imagens/Times/${timeCasa}.png'>
            </td>
        </tr>
        </table>
    </tr>
    </table>`;
    return tabela;
    }
</script>

<script type="text/javascript" src="funcoes.js"></script>
<script>
    function verificar(){
        var usuario = verificar_autenticacao();
        var Site = '';
        if(usuario == 'login'){
            Site = 'Login.html';
        }
        else{
            Site = 'Logout.html';
        }
        console.log(usuario + Site)
        idLogin.innerHTML=usuario;
        idLogin.href=Site;  
    }
    function converterDia(Dia){
        Dia = new Date(Dia);
        var semana=['DOM','SEG','TER','QUA','QUI','SEX','SAB']
        var diaJogo='';
        diaJogo= semana[Dia.getDay()+1];
        diaJogo+=" "+ (Dia.getDate()+1);
        diaJogo+="/"+ (Dia.getMonth()+1);
        return diaJogo;
    }

    function Grupo(Grupo,ArrayTimeGrupo,dadosGrupo){
        var tabela= `
            <h1>Grupo ${Grupo}</h1>
            <table class="Grupo">
                <tr>
                    <th colspan="2" id="classificacao">Classificação</th>
                    <th>P</th>
                    <th>J</th>
                    <th>V</th>
                    <th>E</th>
                    <th>D</th>
                    <th>GP</th>
                    <th>GC</th>
                    <th>SG</th>
                    <th>%</th>
                </tr>
            `;
        for(var contador=0; contador<4; contador++){
            var cor='white';
            if(contador<=1){cor='green';}
            else if(contador==2){cor='blue';}
            tabela +=`
            <tr>
                <td style='color:${cor}'>${contador+1}</td>
                <td>${ArrayTimeGrupo[contador]}</td>
                <td>${dadosGrupo[contador][0]}</td>
                <td>${dadosGrupo[contador][1]}</td>
                <td>${dadosGrupo[contador][2]}</td>
                <td>${dadosGrupo[contador][3]}</td>
                <td>${dadosGrupo[contador][4]}</td>
                <td>${dadosGrupo[contador][5]}</td>
                <td>${dadosGrupo[contador][6]}</td>
                <td>${dadosGrupo[contador][7]}</td>
                <td>${dadosGrupo[contador][8]}%</td>
            </tr>
            `;
        }
        tabela+=`</table>`;
        return tabela;
    }
</script>